# Production Environment Configuration for Contract Deployer API Service
# This file serves as a template for production deployment
# All sensitive values should be stored in AWS SSM Parameter Store

# Server Configuration
NODE_ENV=production
PORT=8002
SERVICE_NAME=contract-deployer-api

# Redis Configuration (ElastiCache)
# Retrieved from SSM: /hokusai/development/contracts/redis_url
REDIS_URL=${SSM_REDIS_URL}
REDIS_RETRY_ATTEMPTS=3
REDIS_RETRY_DELAY=1000

# Blockchain Configuration
# Retrieved from SSM: /hokusai/development/contracts/rpc_endpoint
RPC_URL=${SSM_RPC_ENDPOINT}
RPC_URLS=${SSM_RPC_ENDPOINT}
NETWORK_NAME=polygon-mainnet
CHAIN_ID=137

# Contract Addresses
# Retrieved from SSM: /hokusai/development/contracts/model_registry_address
MODEL_REGISTRY_ADDRESS=${SSM_MODEL_REGISTRY_ADDRESS}
# Retrieved from SSM: /hokusai/development/contracts/token_manager_address
TOKEN_MANAGER_ADDRESS=${SSM_TOKEN_MANAGER_ADDRESS}

# Deployment Configuration
# Retrieved from SSM: /hokusai/development/contracts/deployer_key
DEPLOYER_PRIVATE_KEY=${SSM_DEPLOYER_KEY}
DEFAULT_GAS_LIMIT=5000000
GAS_PRICE_MULTIPLIER=1.2
MAX_GAS_PRICE=500000000000
MIN_CONFIRMATIONS=2
CONFIRMATION_TIMEOUT=300000

# API Configuration
# Retrieved from SSM: /hokusai/development/contracts/api_keys
API_KEYS=${SSM_API_KEYS}
# Retrieved from SSM: /hokusai/development/contracts/jwt_secret
JWT_SECRET=${SSM_JWT_SECRET}
ENABLE_AUTH=true

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW=3600000
RATE_LIMIT_MAX_REQUESTS_PER_HOUR=5
RATE_LIMIT_MAX_REQUESTS_PER_DAY=20

# CORS Configuration
CORS_ENABLED=true
CORS_ORIGINS=https://app.hokus.ai,https://hokus.ai,https://admin.hokus.ai

# Monitoring & Logging
LOG_LEVEL=info
LOG_FORMAT=json
ENABLE_METRICS=true
METRICS_PORT=9091

# Health Check Configuration
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000

# Queue Configuration (for listener mode)
QUEUE_PREFIX=hokusai
MODEL_READY_QUEUE=model_ready_queue
TOKEN_DEPLOYED_QUEUE=token_deployed_queue
DLQ_NAME=dlq
PROCESSING_QUEUE=processing_queue
MAX_RETRIES=3
RETRY_DELAY=5000

# Webhook Configuration (optional)
# Retrieved from SSM if configured: /hokusai/development/contracts/webhook_url
WEBHOOK_URL=${SSM_WEBHOOK_URL}
# Retrieved from SSM if configured: /hokusai/development/contracts/webhook_secret
WEBHOOK_SECRET=${SSM_WEBHOOK_SECRET}
WEBHOOK_TIMEOUT=5000

# AWS Configuration
AWS_REGION=us-east-1
AWS_ACCOUNT_ID=932100697590

# CloudWatch Configuration
CLOUDWATCH_LOG_GROUP=/ecs/hokusai-contracts
CLOUDWATCH_LOG_STREAM_PREFIX=contract-deployer-api

# Feature Flags
ENABLE_DEPLOYMENT_SIMULATION=false
ENABLE_DRY_RUN=false
ENABLE_WEBHOOK_NOTIFICATIONS=true

# Performance Tuning
MAX_CONCURRENT_DEPLOYMENTS=10
DEPLOYMENT_QUEUE_SIZE=100
CONNECTION_POOL_SIZE=10

# Security
HELMET_ENABLED=true
TRUST_PROXY=true

# Development/Debug (should be false in production)
DEBUG=false
VERBOSE_LOGGING=false

# AMM Monitoring Configuration
# Network (determines which deployment artifact to load)
NETWORK=mainnet

# RPC Configuration for Monitoring
# Retrieved from SSM: /hokusai/development/contracts/mainnet_rpc_url
MAINNET_RPC_URL=${SSM_MAINNET_RPC_URL}
# Retrieved from SSM: /hokusai/development/contracts/sepolia_rpc_url
SEPOLIA_RPC_URL=${SSM_SEPOLIA_RPC_URL}
# Retrieved from SSM (optional): /hokusai/development/contracts/backup_rpc_url
BACKUP_RPC_URL=${SSM_BACKUP_RPC_URL}

# Monitoring Toggles
MONITORING_ENABLED=true
POOL_DISCOVERY_ENABLED=true
EVENT_LISTENERS_ENABLED=true
STATE_POLLING_ENABLED=true
ALERTS_ENABLED=true

# Monitoring Intervals
MONITORING_INTERVAL_MS=120000             # State polling interval (120s = 10 blocks, reduced from 12s)
MONITORING_START_BLOCK=latest             # Start from 'latest' or specific block number

# Alert Configuration
# Retrieved from SSM: /hokusai/development/monitoring/alert_email
ALERT_EMAIL=${SSM_ALERT_EMAIL}
ALERT_EMAIL_FROM=alerts@hokus.ai
AWS_SES_REGION=us-east-1

# Alert Rate Limiting
MAX_ALERTS_PER_HOUR=10
MAX_ALERTS_PER_DAY=50
ALERT_DEDUP_WINDOW_MS=300000              # 5 minutes

# Alert Thresholds
ALERT_RESERVE_DROP_PCT=20
ALERT_PRICE_CHANGE_1H_PCT=20
ALERT_PRICE_CHANGE_24H_PCT=50
ALERT_LARGE_TRADE_USD=10000
ALERT_RESERVE_MIN_USD=1000
ALERT_SUPPLY_CHANGE_1H_PCT=15
ALERT_HIGH_GAS_GWEI=200
ALERT_EXTREME_GAS_GWEI=500
ALERT_TREASURY_FEES_USD=50000
ALERT_IBR_ENDING_HOURS=24
ALERT_PAUSED_DURATION_HOURS=1

# CloudWatch Metrics (future)
AWS_CLOUDWATCH_NAMESPACE=Hokusai/AMM
AWS_CLOUDWATCH_ENABLED=false